import{r as a,A as k,K as w,j as e,L as D,M as S,F as L,N as _,O as F}from"./index-BXbcqYUm.js";import{D as M}from"./DataTable-C3u3g1_w.js";const A=()=>{const[o,t]=a.useState([]),[f,d]=a.useState(!0),[x,n]=a.useState(null),[l,b]=a.useState(""),[j,i]=a.useState(!1),[r,c]=a.useState(null),m=k(),g=[{key:"id",label:"ID",sortable:!0},{key:"full_name",label:"Nombre",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"postal_code",label:"Código Postal",sortable:!0},{key:"is_admin",label:"Administrador",sortable:!0,render:s=>s?e.jsx(L,{className:"admin-icon"}):e.jsx(_,{className:"user-icon"})}],u=a.useCallback(async()=>{try{d(!0);const s=await w();t(s||[]),n(null)}catch(s){console.error("Error al cargar usuarios:",s),n("Error al cargar los usuarios. Por favor, inténtalo de nuevo."),t([])}finally{d(!1)}},[]);a.useEffect(()=>{u()},[u]);const p=s=>{if(s.preventDefault(),l.trim()==="")u();else{const U=o.filter(h=>h.full_name.toLowerCase().includes(l.toLowerCase())||h.email.toLowerCase().includes(l.toLowerCase()));t(U)}},v=s=>{alert(`Detalles del usuario: ${s.full_name}`)},N=s=>{m(`/admin/users/${s.id}`)},y=s=>{c(s),i(!0)},C=async()=>{if(r)try{await F(r.id),t(o.filter(s=>s.id!==r.id)),i(!1),c(null)}catch(s){console.error("Error al eliminar usuario:",s),n("Error al eliminar el usuario. Por favor, inténtalo de nuevo.")}},E=()=>{i(!1),c(null)};return e.jsxs("div",{className:"admin-content",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:"Gestión de Usuarios"}),e.jsxs("button",{className:"add-button",onClick:()=>m("/admin/users/new"),children:[e.jsx(D,{})," Nuevo Usuario"]})]}),e.jsx("div",{className:"search-bar",children:e.jsxs("form",{onSubmit:p,children:[e.jsx("input",{type:"text",placeholder:"Buscar por nombre o email...",value:l,onChange:s=>b(s.target.value)}),e.jsx("button",{type:"submit",children:e.jsx(S,{})})]})}),e.jsx(M,{data:o,columns:g,title:"Usuarios registrados",onView:v,onEdit:N,onDelete:y,loading:f,error:x,emptyMessage:"No hay usuarios registrados"}),j&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsx("h2",{children:"Confirmar eliminación"}),e.jsxs("p",{children:["¿Estás seguro de que deseas eliminar al usuario ",e.jsx("strong",{children:r==null?void 0:r.full_name}),"?"]}),e.jsx("p",{children:"Esta acción no se puede deshacer."}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-button",onClick:E,children:"Cancelar"}),e.jsx("button",{className:"confirm-button",onClick:C,children:"Eliminar"})]})]})})]})};export{A as default};
