import{l as N,A as y,r,j as e,a3 as C,a4 as k,a5 as S,a6 as E,a7 as U}from"./index-Q5swbgvz.js";const D=()=>{const{userId:o}=N(),c=y(),n=o==="new",[s,d]=r.useState({full_name:"",email:"",postal_code:"",is_admin:!1,is_confirmed:!1,role_id:null}),[p,g]=r.useState(!n),[u,m]=r.useState(!1),[h,i]=r.useState(null),[x,f]=r.useState(null);r.useEffect(()=>{(async()=>{if(!n)try{const a=await E(o);d({full_name:a.full_name,email:a.email,postal_code:a.postal_code,is_admin:a.is_admin,is_confirmed:a.is_confirmed,role_id:a.role_id})}catch(a){console.error("Error al cargar datos del usuario:",a),i("Error al cargar los datos del usuario. Por favor, inténtalo de nuevo.")}finally{g(!1)}})()},[o,n]);const l=t=>{const{name:a,value:v,type:_,checked:b}=t.target;d({...s,[a]:_==="checkbox"?b:v})},j=async t=>{t.preventDefault(),m(!0),i(null),f(null);try{n?console.log("Crear nuevo usuario:",s):(await U(o,s),f("Usuario actualizado correctamente"))}catch(a){console.error("Error al guardar usuario:",a),i("Error al guardar los datos del usuario. Por favor, inténtalo de nuevo.")}finally{m(!1)}};return p?e.jsxs("div",{className:"admin-layout",children:[e.jsx(C,{}),e.jsx("div",{className:"admin-content",children:e.jsx("div",{className:"loading-spinner",children:"Cargando..."})})]}):e.jsxs("div",{className:"admin-content",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:n?"Nuevo Usuario":"Editar Usuario"}),e.jsxs("button",{className:"back-button",onClick:()=>c("/admin/users"),children:[e.jsx(k,{})," Volver"]})]}),h&&e.jsx("div",{className:"error-message",children:h}),x&&e.jsx("div",{className:"success-message",children:x}),e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"full_name",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"full_name",name:"full_name",value:s.full_name,onChange:l,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:l,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"postal_code",children:"Código Postal"}),e.jsx("input",{type:"text",id:"postal_code",name:"postal_code",value:s.postal_code,onChange:l,required:!0})]}),e.jsx("div",{className:"form-group checkbox-group",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"is_admin",checked:s.is_admin,onChange:l}),"Administrador"]})}),e.jsx("div",{className:"form-group checkbox-group",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"is_confirmed",checked:s.is_confirmed,onChange:l}),"Cuenta confirmada"]})}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-button",onClick:()=>c("/admin/users"),children:"Cancelar"}),e.jsx("button",{type:"submit",className:"save-button",disabled:u,children:u?"Guardando...":e.jsxs(e.Fragment,{children:[e.jsx(S,{})," Guardar"]})})]})]})})]})};export{D as default};
