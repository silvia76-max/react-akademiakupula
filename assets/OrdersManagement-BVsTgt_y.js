import{r as t,j as e,M as f,P as y,D as w,X as g,Y as _}from"./index-BXbcqYUm.js";const D=()=>{const[n,c]=t.useState([]),[m,i]=t.useState(!0),[o,r]=t.useState(null),[d,x]=t.useState(""),[a,j]=t.useState(null),[u,h]=t.useState(!1);t.useEffect(()=>{(async()=>{try{i(!0);const l=await g();c(Array.isArray(l)?l:[]),r(null)}catch{r("Error al cargar los pedidos. Por favor, inténtalo de nuevo."),c([])}finally{i(!1)}})()},[]);const p=Array.isArray(n)?n.filter(s=>(s.id+"").includes(d)||(s.user_id+"").includes(d)||(s.status||"").toLowerCase().includes(d.toLowerCase())||(s.payment_method||"").toLowerCase().includes(d.toLowerCase())):[],N=s=>{s.preventDefault()},v=s=>{j(s),h(!0)},b=async s=>{if(window.confirm("¿Estás seguro de que deseas eliminar este pedido?"))try{i(!0),await _(s),c(n.filter(l=>l.id!==s)),r(null)}catch{r("Error al eliminar el pedido. Por favor, inténtalo de nuevo.")}finally{i(!1)}};return e.jsxs("div",{className:"admin-content",children:[e.jsx("div",{className:"page-header",children:e.jsx("h1",{children:"Gestión de Pedidos"})}),e.jsx("div",{className:"search-bar",children:e.jsxs("form",{onSubmit:N,children:[e.jsx("input",{type:"text",placeholder:"Buscar por ID, usuario, estado o método de pago...",value:d,onChange:s=>x(s.target.value)}),e.jsx("button",{type:"submit",children:e.jsx(f,{})})]})}),o&&e.jsx("div",{className:"error-message",children:o}),m?e.jsx("div",{className:"loading-spinner",children:"Cargando..."}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"ID Usuario"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Método de pago"}),e.jsx("th",{children:"ID Pago"}),e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:p.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.user_id}),e.jsxs("td",{children:[typeof s.total_amount=="number"?s.total_amount.toFixed(2):"0.00"," €"]}),e.jsx("td",{children:s.status||""}),e.jsx("td",{children:s.payment_method||""}),e.jsx("td",{children:s.payment_id||""}),e.jsx("td",{children:s.created_at?new Date(s.created_at).toLocaleDateString():""}),e.jsxs("td",{className:"actions-cell",children:[e.jsx("button",{className:"view-button",onClick:()=>v(s),title:"Ver detalles",children:e.jsx(y,{})}),e.jsx("button",{className:"delete-button",onClick:()=>b(s.id),title:"Eliminar pedido",children:e.jsx(w,{})})]})]},s.id))})]})}),u&&a&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content order-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:["Pedido #",a.id]}),e.jsx("button",{className:"close-button",onClick:()=>h(!1),children:"×"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"order-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Usuario:"}),e.jsx("span",{className:"detail-value",children:a.user_id})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Total:"}),e.jsxs("span",{className:"detail-value",children:[typeof a.total_amount=="number"?a.total_amount.toFixed(2):"0.00"," €"]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Estado:"}),e.jsx("span",{className:"detail-value",children:a.status||""})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Método de pago:"}),e.jsx("span",{className:"detail-value",children:a.payment_method||""})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"ID Pago:"}),e.jsx("span",{className:"detail-value",children:a.payment_id||""})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Fecha:"}),e.jsx("span",{className:"detail-value",children:a.created_at?new Date(a.created_at).toLocaleDateString():""})]})]})})]})})]})};export{D as default};
